<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=9">
<!--
<meta http-equiv="X-UA-Compatible" content="IE=10">
<meta http-equiv="X-UA-Compatible" content="IE=9">
-->
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Windows PE Shell</title>
<hta:application id="oHTA" applicationname="Xuui Shell"
 border="window" borderstyle="normal" caption="yes" icon="Resources/icon.ico"
 maximizebutton="yes" minimizebutton="yes" showintaskbar="yes"
 singleinstance="yes" sysmenu="yes" version="1.0" windowstate="maximize" scroll="no" />

<!--hta:application id="oHTA" applicationname="Xuui Shell"
 border="none" borderstyle="normal" caption="yes" icon="Resources/icon.ico"
 maximizebutton="yes" minimizebutton="yes" showintaskbar="yes"
 singleinstance="yes" sysmenu="yes" version="1.0" windowstate="maximize" scroll="no"-->   
<script Language="VBScript">
Option Explicit
Dim HTAShell
Set HTAShell=CreateObject("WScript.Shell")
</script>

<link href="./Frameworks/bootstrap.min.css" rel="stylesheet">
<link href="./Resources/ionicons.min.css" rel="stylesheet">
<link href="./Resources/style.css" rel="stylesheet">

</head>
<body>
<section id="desktop">
  <div class="item-icon">
    <a href="#DiskModal" data-toggle="modal">
      <i class="icon ion-filing"></i>
      <span>文件管理器</span>
    </a>
  </div>
  
  <div class="item-icon">
    <a href="#" onClick="HTAShell.run('cmd')">
      <i class="icon ion-ios-paper"></i>
      <span>命令行</span>
    </a>
  </div>

  <div class="item-icon">
    <a href="#" onClick="HTAShell.run('taskmgr')">
      <i class="icon ion-clipboard"></i>
      <span>任务管理器</span>
    </a>
  </div>

  <div class="item-icon">
    <a href="#" onClick="HTAShell.run('notepad')">
      <i class="icon ion-document-text"></i>
      <span>记事本</span>
    </a>
  </div>

  <div class="item-icon">
    <a href="#" id="shell-r">
      <i class="icon ion-xbox"></i>
      <span>安装</span>
    </a>
  </div>

<div id="wpinfo"></div>
    
</section><!-- / #desktop -->

<!-- Modal -->
<div class="modal fade" id="DiskModal" tabindex="-1" role="dialog" aria-labelledby="DiskModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="DiskModalLabel">文件管理器</h4>
      </div>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">文件管理器</a></li>
        <li class="breadcrumb-item active">所有硬盘</li>
      </ol>
      <div class="modal-body container-fluid">
        <div class="row">
          <div class="col-xs-3">
            <div class="icon">
              <i class="ion-social-windows"></i>
              <span>X:</span>
            </div>
          </div>
          <div class="col-xs-3">
            <div class="icon">
              <i class="ion-ios-folder-outline"></i>
              <span>C:</span>
            </div>
          </div>
          <div class="col-xs-3">
            <div class="icon">
                <i class="ion-ios-folder-outline"></i>
              <span>D:</span>
            </div>
          </div>
          <div class="col-xs-3">
            <div class="icon">
                <i class="ion-ios-folder-outline"></i>
              <span>E:</span>
            </div>
          </div>
          <div class="col-xs-3">
            <div class="icon">
                <i class="ion-ios-folder-outline"></i>
              <span>F:</span>
            </div>
          </div>
          <div class="col-xs-3">
            <div class="icon">
                <i class="ion-ios-folder-outline"></i>
              <span>G:</span>
            </div>
          </div>
          <div class="col-xs-3">
            <div class="icon">
                <i class="ion-ios-folder-outline"></i>
              <span>H:</span>
            </div>
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<footer>
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <ul class="nav navbar-nav left-navbar">
      <li class="dropup">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="ion-ios-keypad"></i> <!--span class="caret">&#9776;</span--></a>
        <!--div class="dropdown-menu">
          sfsfsdf
        </div-->
        <ul class="dropdown-menu">
          <li><a href="#">文件管理器</a></li>
          <li role="separator" class="divider"></li>
          <li><a href="#" onClick="HTAShell.run('cmd')">命令行</a></li>
          <li role="separator" class="divider"></li>
          <li><a href="#" onClick="HTAShell.run('taskmgr')">任务管理器</a></li>
        </ul>
      </li>
    </ul>
    <form class="navbar-form navbar-left hidden-xs" role="search">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="command...">
        <span class="input-group-btn"><button class="btn btn-default" type="button"><i class="ion-android-search"></i></button></span>
      </div><!-- /input-group -->
    </form>
    <ul class="nav navbar-nav navbar-right">
      <li class="dropup">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="ion-android-more-vertical"></i> <!--span class="caret"></span--></a>
        <ul class="dropdown-menu">
          <li><a href="#">调整时间</a></li>
          <li><a href="#">系统设置</a></li>
          <li role="separator" class="divider"></li>
          <li><a href="#" onClick="HTAShell.run('wpeutil Reboot')">重新启动</a></li>
          <li><a href="#" onclick="HTAShell.run('wpeutil Shutdown')">关闭电源</a></li>
          <li><a href="#" onclick="self.close()">Close</a></li>
        </ul>
      </li>
    </ul>
  </div>
</nav>
</footer>

<script src="./Frameworks/jquery.min.js"></script>
<script src="./Frameworks/bootstrap.min.js"></script>

<script type="text/javascript">
(function($){

//$('#wpinfo').append("<p>jQuery !!!</p>");
//$('#wpinfo').append("<p>UserAgent: "+ navigator.userAgent + "</p>");
//$('#wpinfo').append("<p>Version: "+ navigator.appVersion + "</p>");
//$('#wpinfo').append("<p>: "+ navigator.appName+navigator.appVersion + "</p>");
//$('#wpinfo').append(navigator.appName+navigator.appVersion);
$('#shell-r').click(function(e){
  pe_run('cmd');
});


function wshell(){
  try{
    return new ActiveXObject("WScript.Shell");
  }catch(e){
    alert("不支持 [WScript.Shell]");
    return null;
  }
}
function pe_exec(cmd){
  if(cmd!=''){
    try{
      oExec=wshell().Exec(cmd);
    }catch(e){
      alert("[" + cmd + "]" + e.description);
      return false;
    }
  }

  if(oExec.status==0){
    setTimeout("pe_exec('')",100);
  }else{
    alert(oExec.StdOut.Readall(),true);
    freeRam();
  }

}

function pe_run(cmd){
  if(cmd!=''){
    wshell().run(cmd);
  }
}

})(jQuery);
</script>

</body>
</html>